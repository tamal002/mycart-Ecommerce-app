{% extends 'shop/base.html' %} 

{% load static %} 

{% block title %}Shop | Home{%endblock %} 

{% block style_sheet %}
<link rel="stylesheet" href="{% static 'shop/css/shophomestyle.css'%}" />
{% endblock %} 



{% block content%}
<div id="products">
  {% for product in product_list %} 
  {% if forloop.counter0|divisibleby:products_per_row %}
  <div class="row">
    {% endif %}

    <div class="card" style="width: 18rem">
      <img src="{{product.image.url}}" class="card-img-top" alt="..." />
      <div class="card-body">
        <h5 class="card-title">{{product.product_name}}</h5>
        <button id="{{product.product_id}}" class="cart">Add to Cart</button>
        {% comment %} <p class="card-text">
          {{product.description}}
        </p> {% endcomment %}
      </div>
    </div>


    {% if forloop.counter|divisibleby:products_per_row %}
    </div>
    {% endif %}
    {% empty %} <p>No products available.</p>
        
  {% endfor %} 
  </div>
  {% endblock %}

  {% block js %}
  
  <script>
    
    if(localStorage.getItem("cart") == null){
      var cart = {};
    }
    else {
      cart = JSON.parse(localStorage.getItem("cart"));
      let cart_area = document.querySelector("#cart");
      cart_area.textContent = Object.keys(cart).length;
    }

    $('.cart').click(function(){
      let product_id = this.id.toString();
      if(cart[product_id] == undefined){
        cart[product_id] = 1;
      }
      else cart[product_id] += 1;

      localStorage.setItem("cart", JSON.stringify(cart));
      console.log(cart);
      let cart_area = document.querySelector("#cart");
      cart_area.textContent = Object.keys(cart).length;
    });

    
  </script>
  
  {% endblock %}
    