{% extends 'shop/base.html' %} 
{% load static %} 

{% block title %}Shop | Home{% endblock %} 

{% block style_sheet %}
<!-- Swiper.js CSS for the carousels -->
<link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css">

<style>
  /* Use the same consistent background as other pages */
  body {
    background-color: #f8f9fa;
  }

  /* Styling for the category headings */
  .category-header {
    font-weight: 600;
    color: #343a40;
    margin-bottom: 1rem;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid #dee2e6;
  }
  
  /* The main container for each slider row */
  .product-slider-container {
    padding: 1rem 0;
    position: relative;
  }

  /* Custom styling for the product cards inside the slider */
  .swiper-slide .card {
    height: 100%; /* Ensures all cards in a row are the same height */
    display: flex;
    flex-direction: column;
    border: 1px solid #dee2e6;
    border-radius: 0.5rem;
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
    transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
  }

  .swiper-slide .card:hover {
    transform: translateY(-5px);
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.1);
  }

  .card-img-top {
    width: 100%;
    height: 180px; /* Fixed height for all images */
    object-fit: cover; /* Ensures images cover the area without distortion */
  }
  
  .card-body {
    flex-grow: 1; /* Allows the card body to fill available space */
    display: flex;
    flex-direction: column;
    padding: 1rem;
  }

  .card-title {
      font-size: 1rem;
      font-weight: 600;
      color: #212529;
  }

  .card-text {
      font-size: 1.1rem;
      font-weight: bold;
      color: #343a40;
      margin-top: auto; /* Pushes price to the bottom */
      margin-bottom: 1rem;
  }

  .card .btn {
      font-size: 0.875rem;
  }

  /* Customizing Swiper navigation buttons */
  .swiper-button-next,
  .swiper-button-prev {
    color: #007bff; /* A more modern blue */
    background-color: rgba(255, 255, 255, 0.8);
    border-radius: 50%;
    width: 40px;
    height: 40px;
    top: 50%;
    transform: translateY(-50%);
  }
  
  .swiper-button-next:after,
  .swiper-button-prev:after {
      font-size: 1.25rem;
      font-weight: bold;
  }

</style>
{% endblock %} 

{% block content%}
<div class="container my-4">
  {% for category, product_list in category_list.items %}
    <div class="mb-5">
      <h2 class="category-header">{{ category }}</h2>
      <div class="swiper product-slider-container">
        <div class="swiper-wrapper">
          
          {% for product in product_list %}
            <div class="swiper-slide">
              <div class="card">
                <a href="{% url 'shop:product_view' product.product_id %}">
                    <img src="{{ product.image.url }}" class="card-img-top" alt="{{ product.product_name }}">
                </a>
                <div class="card-body">
                  <h5 class="card-title">{{ product.product_name }}</h5>
                  <p class="card-text">Rs. {{ product.price }}</p>
                  <div class="d-grid gap-2">
                    <!-- Changed button to an anchor tag -->
                    <a href="{% url "shop:addtocart" product.product_id %}" class="btn btn-primary" role="button">Add to Cart</a>
                  </div>
                </div>
              </div>
            </div>
          {% endfor %}

        </div>
        <!-- Add Pagination -->
        <div class="swiper-button-prev"></div>
        <div class="swiper-button-next"></div>
      </div>
    </div>
  {% empty %}
    <div class="text-center py-5">
        <h3>No Products Found</h3>
        <p class="lead">Please check back later, we are updating our store.</p>
    </div>
  {% endfor %}
</div>
{% endblock %}

{% block js %}
<script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function () {
    // Initialize a Swiper instance for each slider on the page
    document.querySelectorAll('.product-slider-container').forEach(slider => {
        new Swiper(slider, {
            // How many slides to show at once
            slidesPerView: 1, 
            spaceBetween: 20,
            loop: true,
            // Navigation arrows
            navigation: {
                nextEl: slider.querySelector('.swiper-button-next'),
                prevEl: slider.querySelector('.swiper-button-prev'),
            },
            // Responsive breakpoints
            breakpoints: {
                // when window width is >= 576px
                576: {
                    slidesPerView: 2,
                    spaceBetween: 20
                },
                // when window width is >= 768px
                768: {
                    slidesPerView: 3,
                    spaceBetween: 30
                },
                // when window width is >= 992px
                992: {
                    slidesPerView: 4,
                    spaceBetween: 30
                },
                // when window width is >= 1200px
                1200: {
                    slidesPerView: 5,
                    spaceBetween: 30
                }
            }
        });
    });

});
</script>
{% endblock %}

