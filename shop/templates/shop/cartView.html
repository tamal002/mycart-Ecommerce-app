{% extends "shop/base.html" %}

{% block title %}Your Shopping Cart{% endblock %}

{% block style_sheet %}
<style>
  /* Use the same light gray background for consistency */
  body {
    background-color: #f8f9fa;
  }

  /* Re-use the custom card style from the checkout page */
  .card-custom {
    border: 1px solid #dee2e6;
    border-radius: 0.5rem;
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
  }

  /* Style for the product image in the cart */
  .cart-product-img {
    width: 100px;
    height: 100px;
    object-fit: cover;
    border-radius: 0.375rem;
  }
</style>
{% endblock %}

{% block content %}
<div class="container my-4">
  <div class="text-center mb-4">
    <h2>Your Shopping Cart</h2>
    <p class="lead">Review the items in your cart and proceed to checkout.</p>
  </div>

  <div class="row justify-content-center">
    <div class="col-lg-10">
      <div class="card card-custom">
        <div class="card-header bg-light">
          <h4 class="mb-0 text-dark">Cart Items</h4>
        </div>
        
        <!-- Product List -->
        <div class="list-group list-group-flush">

          {% for item in items %}
          <!-- Single Product Item -->
          <div class="list-group-item p-3">
            <div class="d-flex align-items-center">
              <!-- Product Image -->
              <img src="{{ item.product.image.url }}" alt="{{ item.product.product_name }}" class="cart-product-img me-3">
              
              <!-- Product Name -->
              <div class="flex-grow-1">
                <h5 class="mb-1">{{ item.product.product_name }}</h5>
              </div>

              <!-- Product Quantity -->
              <div class="mx-4" style="width: 70px;">
                <div class="text-center">
                   <span class="text-muted small">QTY</span><br>
                   <strong class="fs-5">{{ item.quantity }}</strong>
                </div>
              </div>
              
              <!-- Product Price -->
              <div class="text-end" style="min-width: 80px;">
                <strong class="text-dark">Rs. {{ item.product.price }}</strong>
              </div>

              <!-- Remove Button -->
              <div class="ms-4">
                  <!-- This link should point to a Django URL to handle item removal -->
                  <a href="{% url "shop:removecart" item.product.product_id %}" class="btn btn-outline-danger btn-sm" title="Remove Item">
                    <!-- Bootstrap Trash Icon SVG for better compatibility -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16">
                      <path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm-1.115 1.428a.5.5 0 0 1-.452.586L8.5 4.5V14a.5.5 0 0 1-1 0V4.5l-1.432-.44a.5.5 0 0 1-.586-.452L5.432 2.5h5.136z"/>
                    </svg>
                  </a>
              </div>
            </div>
          </div>
          <!-- End Single Product Item -->
          {% empty %}
            <div class="list-group-item p-3 text-center">
              <h4 class="my-4">Your cart is empty.</h4>
            </div>
          {% endfor %}
        </div>
        <!-- End Product List -->
        
        <!-- Checkout button moved outside the loop for cleaner logic -->
        {% if items %}
        <div class="card-footer p-3 bg-light text-end">
            <a href="{% url 'shop:checkout' %}" class="btn btn-success btn-lg">Proceed to Checkout</a>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}

